<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyFabLab AI</title>
    <style>
        :root {
            --primary: #20808d;
            --primary-hover: #1a6670;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --background: #ffffff;
            --surface: #f8f9fa;
            --border: #e5e7eb;
            --border-light: #f3f4f6;
            --accent: #20808d;
            --success: #10b981;
            --error: #ef4444;
            --sidebar-width: 280px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Prevent horizontal scroll */
        html, body {
            overflow-x: hidden;
            width: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Layout */
        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 0;
            background: var(--surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: width 0.3s ease;
            overflow: hidden;
        }

        .sidebar.open {
            width: var(--sidebar-width);
        }

        /* Sidebar Overlay */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .sidebar-overlay.show {
            display: block;
            opacity: 1;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .close-sidebar {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 4px;
            font-size: 20px;
            line-height: 1;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            margin-bottom: 4px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 14px;
        }

        .nav-item:hover {
            background: var(--border-light);
        }

        .nav-item.active {
            background: var(--primary);
            color: white;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            padding: 16px 24px;
            border-bottom: 1px solid var(--border);
            background: var(--background);
        }

        .menu-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            margin-right: 16px;
            color: var(--text-primary);
            font-size: 20px;
            line-height: 1;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-right: auto;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary);
        }

        .pro-badge {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Chat Area */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            overflow-y: auto;
            background: #f5f7fa;
        }

        .chat-area.has-messages {
            justify-content: flex-start;
            padding-top: 40px;
        }

        /* Welcome Screen */
        .welcome-container {
            background: white;
            border-radius: 24px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 48px 40px;
            animation: fadeIn 0.6s ease-out;
        }

        /* Sauda√ß√£o */
        .greeting {
            text-align: center;
            margin-bottom: 40px;
        }

        .greeting h1 {
            font-size: 32px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .greeting .time-greeting {
            color: #20808d;
            font-weight: 500;
        }

        .greeting p {
            font-size: 18px;
            color: #6b7280;
            margin-top: 8px;
        }

        .model-selector-container {
            margin-bottom: 40px;
        }

        .model-selector-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .model-selector {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px 20px;
            font-size: 15px;
            color: var(--text-primary);
            cursor: pointer;
            width: 100%;
            max-width: 400px;
            text-align: left;
            display: inline-flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s;
        }

        .model-selector:hover {
            border-color: var(--primary);
        }

        /* Search Input - Novo estilo do Jobs */
        .search-container {
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
            position: relative;
        }

        .input-section {
            margin-bottom: 48px;
            position: relative;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 20px 24px;
            transition: all 0.3s ease;
        }

        .input-wrapper:hover {
            border-color: #d1d5db;
            background: #f3f4f6;
        }

        .input-wrapper:focus-within {
            border-color: #20808d;
            background: white;
            box-shadow: 0 0 0 4px rgba(32, 128, 141, 0.1);
        }

        .input-icon {
            font-size: 24px;
            margin-right: 16px;
            opacity: 0.7;
        }

        .main-input {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 18px;
            color: #1a1a1a;
            outline: none;
            font-weight: 400;
        }

        .main-input::placeholder {
            color: #9ca3af;
        }

        .search-tools {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .tool-button {
            background: none;
            border: none;
            padding: 8px;
            cursor: pointer;
            color: var(--text-secondary);
            border-radius: 8px;
            transition: all 0.2s;
            position: relative;
            font-size: 18px;
            line-height: 1;
        }

        .tool-button:hover {
            background: var(--border-light);
            color: var(--text-primary);
        }

        .tool-button.active {
            color: var(--primary);
        }

        .send-button {
            background: #20808d;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .send-button:hover {
            background: #1a6b76;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(32, 128, 141, 0.2);
        }

        .send-button:active {
            transform: translateY(0);
        }

        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Messages */
        .messages-container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .message {
            margin-bottom: 32px;
            animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .message.user .message-avatar {
            background: var(--primary);
            color: white;
        }

        .message.assistant .message-avatar {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-secondary);
        }

        .message-author {
            font-weight: 600;
            color: var(--text-primary);
        }

        .message-content {
            margin-left: 44px;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .message-content p {
            margin-bottom: 16px;
        }

        .message-content p:last-child {
            margin-bottom: 0;
        }

        .message-content code {
            background: var(--surface);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 14px;
        }

        .message-content pre {
            background: var(--surface);
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 16px 0;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 14px;
            margin-left: 44px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typingPulse 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingPulse {
            0%, 60%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            30% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Footer */
        .footer {
            padding: 20px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
            border-top: 1px solid var(--border);
        }

        /* Quick Actions - Novo design do Jobs */
        .quick-actions {
            margin-bottom: 24px;
        }

        .actions-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .actions-title {
            font-size: 16px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .expand-button {
            background: none;
            border: none;
            color: #20808d;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 8px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .expand-button:hover {
            background: rgba(32, 128, 141, 0.1);
        }

        .expand-icon {
            transition: transform 0.3s ease;
        }

        .expand-button.expanded .expand-icon {
            transform: rotate(180deg);
        }

        /* Grid de A√ß√µes */
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            overflow: hidden;
            max-height: 200px;
            transition: max-height 0.4s ease;
        }

        .actions-grid.expanded {
            max-height: 600px;
        }

        .action-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: inherit;
            animation: slideIn 0.4s ease-out;
            animation-fill-mode: both;
        }

        .action-card:hover {
            background: white;
            border-color: #20808d;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .action-card:active {
            transform: translateY(0);
        }

        .action-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .action-content {
            flex: 1;
            min-width: 0;
        }

        .action-title {
            font-size: 15px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .action-description {
            font-size: 13px;
            color: #6b7280;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Anima√ß√µes dos cards */
        .action-card:nth-child(1) { animation-delay: 0.05s; }
        .action-card:nth-child(2) { animation-delay: 0.1s; }
        .action-card:nth-child(3) { animation-delay: 0.15s; }
        .action-card:nth-child(4) { animation-delay: 0.2s; }
        .action-card:nth-child(5) { animation-delay: 0.25s; }
        .action-card:nth-child(6) { animation-delay: 0.3s; }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* GPTs Section */
        .gpts-section {
            padding: 40px 20px;
            background: var(--surface);
            border-top: 1px solid var(--border);
        }

        .gpts-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .gpts-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .gpts-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .gpts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .gpt-card {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .gpt-card:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .gpt-icon {
            width: 48px;
            height: 48px;
            background: var(--surface);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .gpt-info {
            flex: 1;
        }

        .gpt-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .gpt-description {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Model Dropdown */
        .model-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-top: 8px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            max-height: 400px;
            overflow-y: auto;
            z-index: 9999;
        }

        .model-group {
            padding: 8px 0;
        }

        .model-group-title {
            padding: 8px 16px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .model-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .model-option:hover {
            background: var(--surface);
        }

        .model-option.selected {
            background: var(--surface);
            color: var(--primary);
        }

        .model-name {
            font-weight: 500;
        }

        .model-description {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -100%;
                height: 100%;
                z-index: 1000;
                box-shadow: 4px 0 24px rgba(0, 0, 0, 0.1);
                width: var(--sidebar-width);
                max-width: 80vw;
            }

            .sidebar.open {
                left: 0;
            }

            .chat-area {
                padding: 20px 16px;
            }

            .main-content {
                width: 100%;
            }

            .welcome-container {
                padding: 32px 24px;
                max-width: 100%;
            }

            .greeting h1 {
                font-size: 28px;
            }

            .greeting p {
                font-size: 16px;
            }

            .input-wrapper {
                padding: 16px 20px;
                flex-direction: column;
                gap: 12px;
            }

            .main-input {
                font-size: 16px;
                width: 100%;
                padding-right: 16px;
            }

            .send-button {
                width: 100%;
                justify-content: center;
            }

            .actions-grid {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
                max-height: 300px;
            }

            .actions-grid.expanded {
                max-height: 800px;
            }

            .search-tools {
                gap: 2px;
            }

            .tool-button span {
                display: none;
            }

            .quick-action {
                padding: 16px 12px;
            }

            .action-icon {
                font-size: 20px;
            }

            .action-text {
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 12px 16px;
            }

            .logo-text {
                font-size: 18px;
            }

            .welcome-container {
                padding: 20px 16px;
            }

            .greeting h1 {
                font-size: 22px;
                line-height: 1.3;
            }

            .greeting p {
                font-size: 14px;
            }

            .input-icon {
                font-size: 20px;
                margin-right: 12px;
            }

            .main-input {
                font-size: 16px;
                padding: 14px 16px;
            }

            .send-button {
                padding: 12px 16px;
                font-size: 15px;
            }

            .actions-grid {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 0 8px;
            }

            .quick-action {
                padding: 14px 16px;
                gap: 12px;
            }

            .toggle-button {
                padding: 10px 16px;
                font-size: 13px;
            }

            .gpts-section {
                padding: 24px 16px;
            }

            .gpts-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .gpt-card {
                padding: 16px;
            }
        }

        /* Icons */
        .icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* Logo Text */
        .logo-text-large {
            font-size: 48px;
            font-weight: 300;
            letter-spacing: -2px;
            color: var(--primary);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Overlay for mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">MyFabLab AI</h2>
                <button class="close-sidebar" id="closeSidebarBtn">
                    ‚úï
                </button>
            </div>
            <div class="sidebar-content">
                <div class="nav-section">
                    <div class="nav-section-title">In√≠cio</div>
                    <a href="/" class="nav-item active">
                        <span class="nav-icon">‚óã</span>
                        Descobrir
                    </a>
                    <a href="/arena" class="nav-item">
                        <span class="nav-icon">‚öîÔ∏è</span>
                        MMAI Arena
                    </a>
                    <a href="/premium" class="nav-item">
                        <span class="nav-icon">‚ú®</span>
                        Premium
                    </a>
                    <a href="/admin" class="nav-item">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        Admin
                    </a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Espa√ßos</div>
                    <a href="#" class="nav-item">
                        <span class="nav-icon" style="font-weight: 600;">‚Ä¢</span>
                        Assistente
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon" style="font-weight: 600;">‚Ä¢</span>
                        Acad√™mico
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon" style="font-weight: 600;">‚Ä¢</span>
                        Finan√ßas
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon" style="font-weight: 600;">‚Ä¢</span>
                        Esportes
                    </a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">GPTs & Agentes</div>
                    <a href="#" class="nav-item" onclick="showGPTSection()">
                        <span class="nav-icon" style="font-weight: 600;">+</span>
                        Explorar GPTs
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon" style="font-weight: 600;">‚òÖ</span>
                        Meus Favoritos
                    </a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Biblioteca</div>
                    <div class="nav-item" style="color: var(--text-secondary); font-size: 13px;">
                        Suas conversas aparecer√£o aqui
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <button class="menu-toggle" id="menuToggleBtn">
                    ‚ò∞
                </button>
                <div class="logo">
                    <span class="logo-text">MyFabLab AI</span>
                    <span class="pro-badge">Pro</span>
                </div>
            </header>

            <!-- Chat Area -->
            <div class="chat-area" id="chatArea">
                <div class="welcome-container" id="welcomeScreen">
                    <!-- Sauda√ß√£o -->
                    <div class="greeting">
                        <h1><span class="time-greeting" id="timeGreeting">Bom dia</span>, <span id="userName">usu√°rio</span>!</h1>
                        <p>Como posso ajudar voc√™ hoje?</p>
                    </div>
                    
                    <!-- Campo de Input -->
                    <div class="input-section">
                        <div class="input-wrapper">
                            <span class="input-icon">üí≠</span>
                            <input 
                                type="text" 
                                class="main-input" 
                                id="searchInput"
                                placeholder="Pergunte qualquer coisa..."
                                autocomplete="off"
                                autofocus
                            >
                            <button class="send-button" id="sendButton" onclick="window.sendMessage()">
                                Enviar
                                <span>‚Üí</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- A√ß√µes R√°pidas -->
                    <div class="quick-actions">
                        <div class="actions-header">
                            <h2 class="actions-title">A√ß√µes R√°pidas</h2>
                            <button class="expand-button" id="expandButton">
                                <span>Mostrar mais</span>
                                <span class="expand-icon">‚ñº</span>
                            </button>
                        </div>
                        
                        <div class="actions-grid" id="actionsGrid">
                            <!-- Primeiras 4 a√ß√µes sempre vis√≠veis -->
                            <div class="action-card" data-action="criar-design">
                                <span class="action-icon">üé®</span>
                                <div class="action-content">
                                    <div class="action-title">Criar Design</div>
                                    <div class="action-description">Desenvolver novos projetos</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="suporte-tecnico">
                                <span class="action-icon">üîß</span>
                                <div class="action-content">
                                    <div class="action-title">Suporte T√©cnico</div>
                                    <div class="action-description">Ajuda com equipamentos</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="tutoriais">
                                <span class="action-icon">üìö</span>
                                <div class="action-content">
                                    <div class="action-title">Tutoriais</div>
                                    <div class="action-description">Aprender novas t√©cnicas</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="ideias-projeto">
                                <span class="action-icon">üí°</span>
                                <div class="action-content">
                                    <div class="action-title">Ideias de Projeto</div>
                                    <div class="action-description">Inspira√ß√£o para criar</div>
                                </div>
                            </div>
                            
                            <!-- A√ß√µes adicionais (ocultas inicialmente) -->
                            <div class="action-card" data-action="impressao-3d">
                                <span class="action-icon">üñ®Ô∏è</span>
                                <div class="action-content">
                                    <div class="action-title">Impress√£o 3D</div>
                                    <div class="action-description">Configurar impressoras</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="eletronica">
                                <span class="action-icon">‚ö°</span>
                                <div class="action-content">
                                    <div class="action-title">Eletr√¥nica</div>
                                    <div class="action-description">Projetos com Arduino</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="marcenaria">
                                <span class="action-icon">ü™ö</span>
                                <div class="action-content">
                                    <div class="action-title">Marcenaria</div>
                                    <div class="action-description">Trabalhos em madeira</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="corte-laser">
                                <span class="action-icon">üéØ</span>
                                <div class="action-content">
                                    <div class="action-title">Corte a Laser</div>
                                    <div class="action-description">Preparar arquivos</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="colaborar">
                                <span class="action-icon">ü§ù</span>
                                <div class="action-content">
                                    <div class="action-title">Colaborar</div>
                                    <div class="action-description">Encontrar parceiros</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="agendar-visita">
                                <span class="action-icon">üìÖ</span>
                                <div class="action-content">
                                    <div class="action-title">Agendar Visita</div>
                                    <div class="action-description">Reservar hor√°rio</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Seletor de Modelo -->
                    <div class="model-selector-container" style="margin-top: 20px;">
                        <div class="model-selector-label">Modelo de IA</div>
                        <button class="model-selector" id="modelSelectorBtn" onclick="var d=document.getElementById('modelDropdown'); d.style.display = d.style.display === 'block' ? 'none' : 'block'; return false;">
                            <span id="selectedModel">Llama 3.2 3B</span>
                            <span style="font-size: 12px;">‚ñº</span>
                        </button>
                        <div class="model-dropdown" id="modelDropdown">
                            <!-- Model options will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Messages Container -->
                <div class="messages-container" id="messagesContainer" style="display: none;">
                    <!-- Messages will be inserted here -->
                </div>
            </div>

            <!-- GPTs Section -->
            <section class="gpts-section" id="gptsSection">
                <div class="gpts-header">
                    <h2 class="gpts-title">GPTs & Agentes</h2>
                    <p class="gpts-subtitle">Assistentes especializados para suas tarefas</p>
                </div>
                <div class="gpts-grid">
                    <div class="gpt-card" data-gpt="developer">
                        <div class="gpt-icon">üíª</div>
                        <div class="gpt-info">
                            <div class="gpt-name">Desenvolvedor Web</div>
                            <div class="gpt-description">Crie sites e aplica√ß√µes modernas</div>
                        </div>
                    </div>
                    <div class="gpt-card" data-gpt="writer">
                        <div class="gpt-icon">‚úçÔ∏è</div>
                        <div class="gpt-info">
                            <div class="gpt-name">Escritor Criativo</div>
                            <div class="gpt-description">Textos, artigos e conte√∫do criativo</div>
                        </div>
                    </div>
                    <div class="gpt-card" data-gpt="analyst">
                        <div class="gpt-icon">üìä</div>
                        <div class="gpt-info">
                            <div class="gpt-name">Analista de Dados</div>
                            <div class="gpt-description">An√°lises e visualiza√ß√µes de dados</div>
                        </div>
                    </div>
                    <div class="gpt-card" data-gpt="designer">
                        <div class="gpt-icon">üé®</div>
                        <div class="gpt-info">
                            <div class="gpt-name">Designer UI/UX</div>
                            <div class="gpt-description">Design de interfaces e experi√™ncias</div>
                        </div>
                    </div>
                    <div class="gpt-card" data-gpt="teacher">
                        <div class="gpt-icon">üéì</div>
                        <div class="gpt-info">
                            <div class="gpt-name">Professor</div>
                            <div class="gpt-description">Explica√ß√µes did√°ticas e tutoriais</div>
                        </div>
                    </div>
                    <div class="gpt-card" data-gpt="marketing">
                        <div class="gpt-icon">üì¢</div>
                        <div class="gpt-info">
                            <div class="gpt-name">Marketing Digital</div>
                            <div class="gpt-description">Estrat√©gias e campanhas de marketing</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <footer class="footer">
                <p>59 modelos gratuitos dispon√≠veis</p>
            </footer>
        </main>
    </div>

    <script>
        // Configuration - usando backend seguro
        const API_URL = '/api/chat'; // Backend proxy seguro

        // Models data
        const models = [
            { group: 'Recomendados', items: [
                { id: 'meta-llama/llama-3.2-3b-instruct:free', name: 'Llama 3.2 3B', desc: 'R√°pido e eficiente' },
                { id: 'google/gemini-2.0-flash-exp:free', name: 'Gemini 2.0 Flash', desc: '1M de contexto' },
                { id: 'qwen/qwen-2.5-72b-instruct:free', name: 'Qwen 2.5 72B', desc: 'Muito poderoso' }
            ]},
            { group: 'Meta Llama', items: [
                { id: 'meta-llama/llama-3.2-90b-vision-instruct:free', name: 'Llama 3.2 90B Vision', desc: 'Com vis√£o' },
                { id: 'meta-llama/llama-3.2-11b-vision-instruct:free', name: 'Llama 3.2 11B Vision', desc: 'Com vis√£o' },
                { id: 'meta-llama/llama-3.1-70b-instruct:free', name: 'Llama 3.1 70B', desc: 'Grande' },
                { id: 'meta-llama/llama-3.1-8b-instruct:free', name: 'Llama 3.1 8B', desc: 'M√©dio' },
                { id: 'meta-llama/llama-3-8b-instruct:free', name: 'Llama 3 8B', desc: 'Cl√°ssico' }
            ]},
            { group: 'Google', items: [
                { id: 'google/gemma-2-9b-it:free', name: 'Gemma 2 9B', desc: 'Novo' },
                { id: 'google/gemma-7b-it:free', name: 'Gemma 7B', desc: 'Eficiente' }
            ]},
            { group: 'Mistral', items: [
                { id: 'mistralai/mistral-7b-instruct:free', name: 'Mistral 7B', desc: 'Popular' },
                { id: 'mistralai/pixtral-12b:free', name: 'Pixtral 12B', desc: 'Com vis√£o' }
            ]},
            { group: 'Outros', items: [
                { id: 'microsoft/phi-3-mini-128k-instruct:free', name: 'Phi 3 Mini', desc: 'Microsoft' },
                { id: 'openchat/openchat-7b:free', name: 'OpenChat 7B', desc: 'Community' },
                { id: 'inflection/inflection-3-pi', name: 'Inflection Pi', desc: 'Personal AI' }
            ]}
        ];

        // State
        let selectedModelId = 'meta-llama/llama-3.2-3b-instruct:free';
        let messages = [{
            role: 'system',
            content: 'Voc√™ √© um assistente AI √∫til. Responda em portugu√™s de forma clara e amig√°vel.'
        }];

        // Initialize - Usando m√∫ltiplas estrat√©gias para garantir que funcione
        function initializeApp() {
            console.log('Initializing MyFabLab AI...');
            populateModelDropdown();
            setupEventListeners();
            updateGreeting();
            setupInputEffects();
            setupClickHandlers();
            console.log('MyFabLab AI initialized successfully');
        }
        
        // Tentar inicializar de v√°rias formas para garantir
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            // DOM j√° carregado
            initializeApp();
        }
        
        // Fallback para garantir
        window.addEventListener('load', () => {
            if (!window.appInitialized) {
                window.appInitialized = true;
                initializeApp();
            }
        });

        
        // Toggle sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('open');
            
            // Show/hide overlay on mobile
            if (window.innerWidth <= 768) {
                if (sidebar.classList.contains('open')) {
                    overlay.style.display = 'block';
                    setTimeout(() => overlay.classList.add('show'), 10);
                } else {
                    overlay.classList.remove('show');
                    setTimeout(() => overlay.style.display = 'none', 300);
                }
            }
        }

        // Toggle model dropdown
        function toggleModelDropdown() {
            console.log('toggleModelDropdown called');
            const dropdown = document.getElementById('modelDropdown');
            dropdown.classList.toggle('show');
            console.log('Dropdown classes:', dropdown.className);
            
            // Close dropdown when clicking outside
            if (dropdown.classList.contains('show')) {
                setTimeout(() => {
                    document.addEventListener('click', closeDropdownOnClickOutside);
                }, 100);
            }
        }
        
        function closeDropdownOnClickOutside(e) {
            const dropdown = document.getElementById('modelDropdown');
            const button = document.getElementById('modelSelectorBtn');
            if (!dropdown.contains(e.target) && !button.contains(e.target)) {
                dropdown.classList.remove('show');
                document.removeEventListener('click', closeDropdownOnClickOutside);
            }
        }

        // Populate model dropdown
        function populateModelDropdown() {
            const dropdown = document.getElementById('modelDropdown');
            dropdown.innerHTML = models.map(group => `
                <div class="model-group">
                    <div class="model-group-title">${group.group}</div>
                    ${group.items.map(model => `
                        <div class="model-option ${model.id === selectedModelId ? 'selected' : ''}" 
                             onclick="window.selectModel('${model.id}', '${model.name}')">
                            <div>
                                <div class="model-name">${model.name}</div>
                                <div class="model-description">${model.desc}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        // Select model
        function selectModel(modelId, modelName) {
            console.log('selectModel called:', modelId, modelName);
            selectedModelId = modelId;
            document.getElementById('selectedModel').textContent = modelName;
            document.getElementById('modelDropdown').style.display = 'none';
            populateModelDropdown();
            console.log('Model selected:', selectedModelId);
        }

        // Setup event listeners
        function setupEventListeners() {
            const input = document.getElementById('searchInput');
            
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.model-selector-container')) {
                    document.getElementById('modelDropdown').classList.remove('show');
                }
            });
        }

        // Add message to UI
        function addMessage(content, role = 'user') {
            const container = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-avatar">${role === 'user' ? 'Voc√™' : 'AI'}</div>
                    <div class="message-author">${role === 'user' ? 'Voc√™' : selectedModelId.split('/')[1].split('-')[0].charAt(0).toUpperCase() + selectedModelId.split('/')[1].split('-')[0].slice(1)}</div>
                </div>
                <div class="message-content">
                    <p>${content}</p>
                </div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Show typing indicator
        function showTyping() {
            const container = document.getElementById('messagesContainer');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing';
            typingDiv.className = 'message assistant';
            
            typingDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-avatar">AI</div>
                    <div class="message-author">${selectedModelId.split('/')[1].split('-')[0].charAt(0).toUpperCase() + selectedModelId.split('/')[1].split('-')[0].slice(1)}</div>
                </div>
                <div class="typing-indicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                    <span>est√° digitando...</span>
                </div>
            `;
            
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Hide typing indicator
        function hideTyping() {
            const typing = document.getElementById('typing');
            if (typing) typing.remove();
        }

        // Send message
        async function sendMessage() {
            console.log('sendMessage called');
            const input = document.getElementById('searchInput');
            const content = input.value.trim();
            console.log('Message content:', content);
            if (!content) return;

            // Hide welcome screen if visible
            const welcomeScreen = document.getElementById('welcomeScreen');
            const messagesContainer = document.getElementById('messagesContainer');
            const chatArea = document.getElementById('chatArea');
            
            if (welcomeScreen.style.display !== 'none') {
                welcomeScreen.style.display = 'none';
                messagesContainer.style.display = 'block';
                chatArea.classList.add('has-messages');
            }

            // Clear input
            input.value = '';
            
            // Add user message
            addMessage(content, 'user');
            messages.push({ role: 'user', content });

            // Show typing
            showTyping();

            try {
                console.log('Sending to API:', API_URL);
                console.log('Selected model:', selectedModelId);
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: selectedModelId,
                        messages: messages.slice(-10),
                        temperature: 0.7,
                        max_tokens: 1000
                    })
                });

                console.log('API response status:', response.status);
                hideTyping();

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API error:', errorText);
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                console.log('API response data:', data);
                const aiResponse = data.choices[0].message.content;
                
                addMessage(aiResponse, 'assistant');
                messages.push({ role: 'assistant', content: aiResponse });

            } catch (error) {
                console.error('Error in sendMessage:', error);
                hideTyping();
                addMessage('Desculpe, ocorreu um erro. Tente novamente.', 'assistant');
            }
        }

        // Show GPT section
        function showGPTSection() {
            const gptsSection = document.getElementById('gptsSection');
            gptsSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Setup all click handlers
        function setupClickHandlers() {
            console.log('Setting up click handlers...');
            
            // Send button
            const sendBtn = document.getElementById('sendButton');
            if (sendBtn) {
                sendBtn.addEventListener('click', sendMessage);
                console.log('Send button handler added');
            }
            
            // Model selector button
            const modelBtn = document.getElementById('modelSelectorBtn');
            if (modelBtn) {
                modelBtn.addEventListener('click', toggleModelDropdown);
                console.log('Model selector handler added');
            }
            
            // Menu toggle
            const menuBtn = document.getElementById('menuToggleBtn');
            if (menuBtn) {
                menuBtn.addEventListener('click', toggleSidebar);
                console.log('Menu toggle handler added');
            }
            
            // Close sidebar
            const closeBtn = document.getElementById('closeSidebarBtn');
            if (closeBtn) {
                closeBtn.addEventListener('click', toggleSidebar);
            }
            
            // Sidebar overlay
            const overlay = document.getElementById('sidebarOverlay');
            if (overlay) {
                overlay.addEventListener('click', toggleSidebar);
            }
            
            // Expand button
            const expandBtn = document.getElementById('expandButton');
            if (expandBtn) {
                expandBtn.addEventListener('click', toggleExpand);
            }
            
            // GPT section link
            const gptLink = document.getElementById('gptSectionLink');
            if (gptLink) {
                gptLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    showGPTSection();
                });
            }
            
            // Action cards
            document.querySelectorAll('.action-card[data-action]').forEach(card => {
                card.addEventListener('click', () => {
                    const action = card.dataset.action;
                    console.log('Action clicked:', action);
                    quickAction(action);
                });
            });
            
            // GPT cards
            document.querySelectorAll('.gpt-card[data-gpt]').forEach(card => {
                card.addEventListener('click', () => {
                    const gptType = card.dataset.gpt;
                    console.log('GPT clicked:', gptType);
                    useGPT(gptType);
                });
            });
            
            console.log('Click handlers setup complete');
        }

        // Use GPT
        function useGPT(type) {
            const gptPrompts = {
                developer: "Voc√™ √© um desenvolvedor web experiente. Ajude-me com programa√ß√£o, cria√ß√£o de sites e aplica√ß√µes.",
                writer: "Voc√™ √© um escritor criativo profissional. Ajude-me com textos, artigos e conte√∫do criativo.",
                analyst: "Voc√™ √© um analista de dados experiente. Ajude-me com an√°lises, visualiza√ß√µes e insights de dados.",
                designer: "Voc√™ √© um designer UI/UX talentoso. Ajude-me com design de interfaces e experi√™ncias do usu√°rio.",
                teacher: "Voc√™ √© um professor did√°tico e paciente. Explique conceitos de forma clara e crie tutoriais passo a passo.",
                marketing: "Voc√™ √© um especialista em marketing digital. Ajude-me com estrat√©gias e campanhas de marketing."
            };

            // Update system message
            messages[0].content = gptPrompts[type] || messages[0].content;
            
            // Show confirmation
            const input = document.getElementById('searchInput');
            input.value = `Iniciando modo ${type === 'developer' ? 'Desenvolvedor' : type === 'writer' ? 'Escritor' : type === 'analyst' ? 'Analista' : type === 'designer' ? 'Designer' : type === 'teacher' ? 'Professor' : 'Marketing'}...`;
            input.focus();
            
            // Clear after 2 seconds
            setTimeout(() => {
                input.value = '';
            }, 2000);
        }

        // Toggle expand/collapse quick actions
        function toggleExpand() {
            const grid = document.getElementById('actionsGrid');
            const button = document.querySelector('.expand-button');
            const buttonText = button.querySelector('span:first-child');
            
            grid.classList.toggle('expanded');
            button.classList.toggle('expanded');
            
            if (grid.classList.contains('expanded')) {
                buttonText.textContent = 'Mostrar menos';
            } else {
                buttonText.textContent = 'Mostrar mais';
            }
        }

        // Update greeting based on time
        function updateGreeting() {
            const hour = new Date().getHours();
            const greetingEl = document.getElementById('timeGreeting');
            
            let greeting = 'Ol√°';
            if (hour >= 5 && hour < 12) {
                greeting = 'Bom dia';
            } else if (hour >= 12 && hour < 18) {
                greeting = 'Boa tarde';
            } else if (hour >= 18 && hour < 23) {
                greeting = 'Boa noite';
            } else {
                greeting = 'Boa madrugada';
            }
            
            greetingEl.textContent = greeting;
        }

        // Setup input effects
        function setupInputEffects() {
            const inputWrapper = document.querySelector('.input-wrapper');
            const mainInput = document.querySelector('.main-input');
            
            if (mainInput) {
                mainInput.addEventListener('focus', () => {
                    inputWrapper.style.transform = 'scale(1.02)';
                });
                
                mainInput.addEventListener('blur', () => {
                    inputWrapper.style.transform = 'scale(1)';
                });
            }
        }

        // Handle quick actions
        function quickAction(action) {
            const actionPrompts = {
                'criar-design': 'Quero criar um novo design. Como posso come√ßar?',
                'suporte-tecnico': 'Preciso de suporte t√©cnico com os equipamentos do FabLab.',
                'tutoriais': 'Quais tutoriais est√£o dispon√≠veis para aprender novas t√©cnicas?',
                'ideias-projeto': 'Preciso de ideias para um novo projeto. Pode me ajudar?',
                'impressao-3d': 'Como configurar a impressora 3D para meu projeto?',
                'eletronica': 'Quero come√ßar um projeto com Arduino. Por onde come√ßo?',
                'marcenaria': 'Quais ferramentas de marcenaria est√£o dispon√≠veis no FabLab?',
                'corte-laser': 'Como preparar meus arquivos para corte a laser?',
                'colaborar': 'Como posso encontrar parceiros para colaborar em projetos?',
                'agendar-visita': 'Como fa√ßo para agendar uma visita ao FabLab?'
            };

            const input = document.getElementById('searchInput');
            input.value = actionPrompts[action] || '';
            input.focus();
            
            // Auto send after a short delay
            setTimeout(() => {
                sendMessage();
            }, 500);
        }
        
        // Tornar fun√ß√µes globais para garantir acesso (no final, ap√≥s todas serem definidas)
        window.toggleSidebar = toggleSidebar;
        window.toggleModelDropdown = toggleModelDropdown;
        window.sendMessage = sendMessage;
        window.selectModel = selectModel;
        window.quickAction = quickAction;
        window.useGPT = useGPT;
        window.toggleExpand = toggleExpand;
        window.showGPTSection = showGPTSection;
    </script>
    
    <!-- Fix para o dropdown -->
    <script src="fix-dropdown.js"></script>
    
    <!-- Inicializa√ß√£o inline como fallback -->
    <script>
        // Garantir que a inicializa√ß√£o aconte√ßa
        setTimeout(() => {
            if (typeof initializeApp === 'function' && !window.appInitialized) {
                console.log('Forcing initialization...');
                window.appInitialized = true;
                initializeApp();
            }
        }, 1000);
    </script>
</body>
</html>