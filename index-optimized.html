<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Chat AI - Interface inteligente para conversar com modelos de IA">
    <title>Chat AI - OpenRouter</title>
    
    <!-- Critical CSS inline para renderiza√ß√£o mais r√°pida -->
    <style>
        :root{--color-background:#fcfcf9;--color-surface:#fffffe;--color-text:#13343b;--color-text-secondary:#626a6d;--color-primary:#21808d;--color-border:rgba(94,82,64,.2);--font-family-base:"FKGroteskNeue","Geist","Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;--space-16:16px;--space-24:24px;--radius-lg:12px}
        *{box-sizing:border-box}
        body{margin:0;font-family:var(--font-family-base);color:var(--color-text);background:var(--color-background);line-height:1.5}
        .header{background:var(--color-surface);border-bottom:1px solid var(--color-border);padding:var(--space-16) 0;position:sticky;top:0;z-index:100;height:80px}
        .container{width:100%;display:flex;height:calc(100vh - 80px);padding:0}
        .hidden{display:none!important}
        .loading-initial{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center}
        .spinner{width:40px;height:40px;border:4px solid var(--color-border);border-top:4px solid var(--color-primary);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 16px}
        @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    </style>
    
    <!-- Preload recursos cr√≠ticos -->
    <link rel="preload" href="style.css" as="style">
    <link rel="preload" href="app-optimized.js" as="script">
    <link rel="preconnect" href="https://r2cdn.perplexity.ai">
    <link rel="dns-prefetch" href="https://openrouter.ai">
    
    <!-- Carregar CSS de forma n√£o bloqueante -->
    <link rel="stylesheet" href="style.css" media="print" onload="this.media='all';this.onload=null;">
    <noscript><link rel="stylesheet" href="style.css"></noscript>
</head>
<body>
    <!-- Loading inicial enquanto o JS carrega -->
    <div class="loading-initial" id="initialLoader">
        <div class="spinner"></div>
        <p>Carregando Chat AI...</p>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="header-title">ü§ñ Chat AI</h1>
                <div class="header-actions">
                    <button class="btn btn--outline btn--sm" id="themeToggle" aria-label="Alternar tema">
                        <span id="themeIcon">üåô</span>
                    </button>
                    <button class="btn btn--secondary btn--sm" id="settingsBtn" aria-label="Abrir configura√ß√µes">
                        ‚öôÔ∏è Configura√ß√µes
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content (ser√° populado pelo JavaScript) -->
    <main class="main" id="mainContent">
        <!-- Conte√∫do ser√° injetado aqui -->
    </main>

    <!-- Modais e overlays ser√£o adicionados dinamicamente -->

    <!-- Scripts com loading otimizado -->
    <script>
        // Remove loader quando o conte√∫do principal carregar
        window.addEventListener('DOMContentLoaded', function() {
            const loader = document.getElementById('initialLoader');
            if (loader) {
                setTimeout(() => {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.remove(), 300);
                }, 100);
            }
        });

        // Detectar prefer√™ncia de tema do sistema
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-color-scheme', 'dark');
        }

        // Web Font loader otimizado
        if ('fonts' in document) {
            const font = new FontFace('FKGroteskNeue', 'url(https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2)');
            font.load().then(function(loadedFont) {
                document.fonts.add(loadedFont);
            }).catch(function() {
                console.log('Font loading failed, using fallback');
            });
        }
    </script>

    <!-- JavaScript principal com defer para n√£o bloquear -->
    <script src="app-optimized.js" defer></script>

    <!-- Service Worker para cache offline -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').catch(err => {
                    console.log('ServiceWorker registration failed:', err);
                });
            });
        }
    </script>
</body>
</html>